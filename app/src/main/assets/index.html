<html>
<head>
    <style type="text/css">p { font-family : monospace; }</style>
</head>
<body>

<hi>Click the button to get your coordinates.</hi>

<!--
<button onclick="getLocation()">Try It</button>
-->

<p id="demo"></p>
<br>
<p id="demowatch"></p>
<br>
<br>

<p> +_current latitude:         <span></span><br>
    -_initial latitude:         <span></span><br>
    =_________________:         <span></span></p>
<p> +_current longitude:        <span></span><br>
    -_initial longitude:        <span></span><br>
    =__________________:        <span></span></p>
<p> +_current altitude:         <span></span><br>
    -_initial altitude:         <span></span><br>
    =_________________:         <span></span></p>
<p> +_current accuracy:         <span></span><br>
    -_initial accuracy:         <span></span><br>
    =_________________:         <span></span></p>
<p> +_current altitudeAccuracy: <span></span><br>
    -_initial altitudeAccuracy: <span></span><br>
    =_________________________: <span></span></p>
<p> +_current heading:          <span></span><br>
    -_initial heading:          <span></span><br>
    =________________:          <span></span></p>
<p> +_current speed:            <span></span><br>
    -_initial speed:            <span></span><br>
    =______________:            <span></span></p>
<p> +_current local time:       <span></span><br>
    -_initial local time:       <span></span><br>
    =___________________:       <span></span></p>

<script>

var x = document.getElementById("demo");
var w = document.getElementById("demowatch");
var watchID;

//x.innerHTML = "Geolocation";


function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);

    //navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
    //navigator.geolocation.getCurrentPosition(
    //successCallback, errorCallback, {enableHighAccuracy:false; timeout:6000; maximumAge:0;}
    //);.toLocaleTimeString()

    watchID = navigator.geolocation.watchPosition(
        function(position){
               spans = document.querySelectorAll('p span');
               spans[0].textContent = position.coords.latitude;
               spans[3].textContent = position.coords.longitude;
               spans[6].textContent = position.coords.altitude;
               spans[9].textContent = position.coords.accuracy;
               spans[12].textContent = position.coords.altitudeAccuracy;
               spans[15].textContent = position.coords.heading;
               spans[18].textContent = position.coords.speed;
               //spans[21].textContent = position.timestamp.toLocaleTimeString();
               now = new Date(position.timestamp);
               spans[21].textContent = now.toLocaleTimeString();
               //spans[21].textContent = new Date(position.timestamp).toLocaleString();


               spans[2].textContent = (spans[0].textContent - spans[1].textContent).toFixed(7);
               spans[5].textContent = (spans[3].textContent - spans[4].textContent).toFixed(7);
               spans[8].textContent = (spans[6].textContent - spans[7].textContent).toFixed(7);
               spans[11].textContent = (spans[9].textContent - spans[10].textContent).toFixed(7);
               spans[14].textContent = (spans[12].textContent - spans[13].textContent).toFixed(7);
               spans[17].textContent = (spans[15].textContent - spans[16].textContent).toFixed(7);
               spans[20].textContent = (spans[18].textContent - spans[19].textContent).toFixed(7);

               //spans[23].textContent = (spans[21].textContent - spans[22].textContent).toFixed(7);
               //spans[23].textContent = Math.round((now - initTime)/1000.0);
               //spans[23].textContent = Math.floor(now/1000.0) - Math.floor(initTime/1000.0);
               fullSeconds = Math.floor(now/1000.0) - Math.floor(initTime/1000.0);

               var paddingZero = function(n) {
                    return (n < 10) ? '0' + n : n;
               };

               second = Math.floor(fullSeconds % 60);
               second = paddingZero(second);
               spans[23].textContent = ':' + second;

            //const now = new Date();
            //let gl_txt = "latitude: "         + position.coords.latitude + "<br>";
            //  gl_txt +=  "longitude: "        + position.coords.longitude + "<br>";
            //  gl_txt +=  "altitude: "         + position.coords.altitude + "<br>";
            //  gl_txt +=  "accuracy: "         + position.coords.accuracy + "<br>";
            //  gl_txt +=  "altitudeAccuracy: " + position.coords.altitudeAccuracy + "<br>";
            //  gl_txt +=  "heading: "          + position.coords.heading + "<br>";
            //  gl_txt +=  "speed: "            + position.coords.speed + "<br>";
            //  gl_txt +=  "local time: "       + now.toLocaleTimeString() + "<br>";
            //  w.innerHTML = gl_txt;
        },null);
  } else {
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

getLocation();


function showPosition(position) {
    spans = document.querySelectorAll('p span');
    spans[1].textContent = position.coords.latitude;
    spans[4].textContent = position.coords.longitude;
    spans[7].textContent = position.coords.altitude;
    spans[10].textContent = position.coords.accuracy;
    spans[13].textContent = position.coords.altitudeAccuracy;
    spans[16].textContent = position.coords.heading;
    spans[19].textContent = position.coords.speed;

    initTime = new Date(position.timestamp);
    spans[22].textContent = initTime.toLocaleTimeString();
    //spans[22].textContent = new Date(position.timestamp).toLocaleTimeString();


  //x.innerHTML = "Latitude: " + position.coords.latitude +
  //"<br>Longitude: " + position.coords.longitude +
  //"<br>Altitutude: " + position.coords.altitude +
  //"<br>Accuracy: " + position.coords.accuracy;

  //x.innerHTML = "";
  //for (var key in position.coords) {
  //x.innerHTML += key;
  //}
  }

 function successCallback(position) {
  const date = new Date();
  var gl_text = "latitude: "         + position.coords.latitude + "<br>";
    gl_text +=  "longitude: "        + position.coords.longitude + "<br>";
    gl_text +=  "altitude: "         + position.coords.altitude + "<br>";
    gl_text +=  "accuracy: "         + position.coords.accuracy + "<br>";
    gl_text +=  "altitudeAccuracy: " + position.coords.altitudeAccuracy + "<br>";
    gl_text +=  "heading: "          + position.coords.heading + "<br>";
    gl_text +=  "speed: "            + position.coords.speed + "<br>";
    gl_text +=  "local time: "       + date.toLocaleTimeString() + "<br>";
    x.innerHTML = gl_text;
}

function errorCallback(error) {
  var err_msg = "";
  switch(error.code)
  {
    case 1:
      err_msg = "PERMISSION_DENIEDÂ“";
      break;
    case 2:
      err_msg = "POSITION_UNAVAILABLE";
      break;
    case 3:
      err_msg = "TIMEOUT";
      break;
  }
  x.innerHTML = err_msg;
}

</script>

</body>
</html>

